\documentclass[a4paper, 10pt]{scrartcl}

\usepackage{a4wide}
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{hyperref}

\usepackage{tikz}
\usetikzlibrary{positioning,calc,shapes,arrows,shapes.multipart}

\usepackage{scrpage2}
\pagestyle{scrheadings}
\clearscrheadfoot

\makeatletter

\def \autoren {Felix Starke, Lars Hübner}
\def \titel {Metronom für Intel 8051}
\def \arbeit {Projekt Systemnahe Programmierung}
\def \uni {DHBW Karlsruhe}
\def \betreuer {Herr Lausen}
\def \datum {6. Juni 2018}

\title{\titel}
\author{\autoren}
\date{\datum}

\ihead{\titel}
\ohead{\autoren}
\ofoot{\pagemark}

\begin{document}

\begin{titlepage}
	\centering
	\includegraphics[width=0.4\textwidth]{dhbw.png}\par\vspace{1cm}
	{\scshape\LARGE \uni \par}
	\vspace{1cm}
	{\scshape\Large \arbeit\par}
	\vspace{1.5cm}
	{\huge\bfseries \titel\par}
	\vspace{2cm}
	{\Large\itshape \autoren\par}
	\vfill
	betreut von\par
	\textsc{\betreuer}

	\vfill

% Bottom of the page
	{\large \datum\par}
\end{titlepage}

\newpage
\tableofcontents
\newpage

\section{Einleitung}
\subsection{Motivation}

Ein Metronom beschreibt ein mechanisches oder elektronisches Gerät, welches zur regelmäßigen Tonerzeugung genutzt wird um musikalische Rhythmen zu unterstützen. Die Mehrzahl der neueren Metronome haben eine Funktion, bei der über ein regelmäßiges Klicken auf einen Button der entsprechende Klick-Takt übernommen wird.
\\
Da Metronome häufig als kleine portable Geräte mit geringem Stromverbrauch umgesetzt werden, kann eine entsprechende Funktionalität auf einem Intel 8051 Mikrocontroller implementiert werden. Die Programmierung auf diesem Mikrocomputer geschieht in Assembler. Ziel dieses Projektes ist entsprechend die Implementierung einer solchen "Tap to Beat" Funktion in Assembler für den 8051.

\subsection{Aufgabenstellung}

\textbf{Recording}
\\
\textbf{Display Metronom}

\section{Grundlagen}
\subsection{Assembler}
\subsection{Intel 8051 Mikrocontroller}
\subsection{Entwicklungsumgebung MCU-8051}

\section{Konzept}
\subsection{Eingaben, Ausgaben und Ports}
Um dem Metronom den Takt vorzugeben, kommt eine 4x4 Keypad-Matrix (siehe \autoref{fig:keypad}) zur Eingabe zum Einsatz. Diese ist an alle acht Pins von Port 0 angeschlossen. Dabei werden die Pins 0-3 für die vier Spalten der Matrix und Pins 4-7 für die Zeilen der Matrix verwendet. Um eine gedrückte Teste zu detektieren müssen zunächst die Pins 0-3 auf "1" gesetzt werden und die Pins 4-7 gelesen werden. So lässt sich herausfinden, ob überhaupt eine Taste gedrückt ist und welcher Spalte diese angehört. Im nächsten Takt können dann die Pins 4-7 auf "1" gesetzt werden und 0-3 auf "0". Anschließend kann die Zeile der gedrückten Taste ermittelt werden.
\begin{figure}[h]
\centering
\includegraphics[width=0.5\textwidth]{keypad.png}
\caption{Keypad Matrix}
\label{fig:keypad}
\end{figure}
\\
\\
Für die Ausgabe des ermittelten Taktes wird eine 8x8 LED-Matrix (siehe \autoref{fig:led}) verwendet. diese ist an die Ports 2 und 3 angeschlossen. Die acht Pins von Port 2 werden genutzt um die Spalten der Matrix anzusteuern, die acht Pins von Port 3 werden für die Zeilen der LED-Matrix verwendet. Eine der 64 LED's leuchtet genau dann, wenn sowohl der Pin der entsprechenden Zeile als auch der entsprechenden Spalte gesetzt sind.
\begin{figure}[h]
\centering
\includegraphics[width=0.5\textwidth]{led.png}
\caption{LED Matrix}
\label{fig:led}
\end{figure}
\subsection{Programmablauf}

% Include flow chart definition
\include{flow_diagram_definition}

\section{Besondere Schwierigkeiten}
Besondere Schwierigkeiten ergaben sich aufgrund der hohen Laufzeiten durch die Entwicklungsumgebung. Vorallem die Nutzung virtueller Hardware verlangsamt den Ablauf des Programms stark. So vergehen, auf einem recht leistungsstarken Rechner, etwa 7 Sekunden, bis im Simulator der Entwicklungsumgebung eine Millisekunde verstrichen ist. Da gutes Timing für ein Metronom sehr wichtig ist, musste entschieden werden, wie mit der langsamen Laufzeit umgegangen werden sollte. Da das Metronom nutzbar sein sollte wurde das Timing nicht an der simulierten Laufzeit der Entwicklungsumgebung orientiert. Da weder die Eingabe zur Festlegung des Taktes noch die Ausgabe des Takts über die LED-Matrix an die Zeit der Simulation gebunden sind, ist es einfach möglich, beides zu synchronisieren und so umzusetzten, dass das Metronom nutzbar ist.
\\

\section{Zusammenfassung}

\section{Literatur}
\section{Eidesstattliche Versicherung}
\end{document}
